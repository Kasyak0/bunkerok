<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–≥—Ä–∞ "–ë—É–Ω–∫–µ—Ä" - –û–Ω–ª–∞–π–Ω</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #1a0b2e 0%, #2d1b4e 50%, #3d2c5f 100%);
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }
        
        .screen {
            min-height: 100vh;
            position: relative;
        }
        
        .screen.hidden {
            display: none !important;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #6a4c93 0%, #8e44ad 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(106, 76, 147, 0.3);
            margin: 5px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(106, 76, 147, 0.4);
            background: linear-gradient(135deg, #7a5ca3 0%, #9e54bd 100%);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            margin: 15px 0;
        }
        
        h1 {
            font-size: 3rem;
            font-weight: 700;
            text-align: center;
            background: linear-gradient(135deg, #ffffff 0%, #e0c3fc 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 30px;
        }
        
        .input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.05);
            color: white;
            font-size: 16px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            margin: 10px 0;
        }
        
        .input:focus {
            outline: none;
            border-color: #8e44ad;
            box-shadow: 0 0 0 3px rgba(142, 68, 173, 0.2);
            background: rgba(255, 255, 255, 0.08);
        }
        
        .input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        .status {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            z-index: 1000;
            background: #2ecc71;
            color: white;
        }
        
        .status.offline {
            background: #e74c3c;
        }
        
        .status.connecting {
            background: #f39c12;
        }
        
        .error {
            background: rgba(231, 76, 60, 0.1);
            border: 1px solid rgba(231, 76, 60, 0.5);
            color: #e74c3c;
            padding: 15px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: center;
        }
        
        .players-list {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
        }
        
        .player-item {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-weight: 500;
        }
        
        /* –ò–≥—Ä–æ–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ */
        .player-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            min-height: 400px;
            transition: all 0.3s ease;
        }
        
        .player-card.current-player {
            border-color: #8e44ad;
            box-shadow: 0 0 20px rgba(142, 68, 173, 0.3);
        }
        
        .player-card.eliminated {
            opacity: 0.5;
            filter: grayscale(100%);
            transform: scale(0.95);
        }
        
        .player-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .player-name {
            margin: 0;
            font-size: 1.2rem;
            color: white;
            font-weight: 600;
        }
        
        .eliminated-badge {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .vote-btn {
            padding: 8px 16px;
            font-size: 14px;
            min-width: 100px;
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }
        
        .vote-btn:hover {
            background: linear-gradient(135deg, #f75c4c 0%, #d0493b 100%);
        }
        
        .characteristics-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .characteristic-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            flex-wrap: wrap;
            gap: 5px;
        }
        
        .characteristic-item:last-child {
            border-bottom: none;
        }
        
        .characteristic-label {
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            font-weight: 500;
            min-width: 80px;
        }
        
        .characteristic-value {
            text-align: right;
            flex: 1;
            margin-left: 10px;
        }
        
        .revealed-value {
            color: white;
            font-weight: 500;
            font-size: 14px;
        }
        
        .own-value {
            color: #a8e6cf;
            font-weight: 500;
            font-size: 14px;
            background: rgba(168, 230, 207, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
        }
        
        .characteristic-preview {
            color: #a8e6cf;
            font-size: 12px;
            opacity: 0.8;
            margin-top: 4px;
            font-style: italic;
        }
        
        .hidden-value {
            color: rgba(255, 255, 255, 0.4);
            font-style: italic;
        }
        
        .reveal-btn {
            padding: 4px 12px;
            font-size: 12px;
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3);
        }
        
        .reveal-btn:hover {
            background: linear-gradient(135deg, #4aa8eb 0%, #3990c9 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
        }
        
        .votes-display {
            margin-top: 15px;
            padding: 10px;
            background: rgba(231, 76, 60, 0.1);
            border: 1px solid rgba(231, 76, 60, 0.3);
            border-radius: 8px;
            text-align: center;
            color: #e74c3c;
            font-weight: 600;
        }
        
        .survivor {
            padding: 15px 25px;
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
            border-radius: 12px;
            font-weight: 600;
            font-size: 18px;
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3);
        }
        
        @media (max-width: 768px) {
            h1 { font-size: 2rem; }
            .container { padding: 10px; }
        }
    </style>
</head>
<body>
    <div class="status" id="status">üü° –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...</div>
    
    <div class="container">
        <!-- –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ -->
        <div id="lobby" class="screen">
            <h1>–ò–≥—Ä–∞ "–ë—É–Ω–∫–µ—Ä"</h1>
            <div style="max-width: 400px; margin: 0 auto;">
                <div class="card">
                    <h2 style="text-align: center; margin-bottom: 20px;">üåç –ì–ª–æ–±–∞–ª—å–Ω–æ–µ –ª–æ–±–±–∏</h2>
                    <input type="text" id="playerName" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è" class="input" maxlength="20">
                    <button id="joinBtn" class="btn" style="width: 100%;">–í–æ–π—Ç–∏ –≤ –∏–≥—Ä—É</button>
                    
                    <div id="error" class="error" style="display: none;">
                        –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è!
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px; color: rgba(255,255,255,0.7); font-size: 14px;">
                        <p>–û–¥–Ω–æ –ª–æ–±–±–∏ –¥–ª—è –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ –º–∏—Ä–∞!</p>
                        <p>–ü–µ—Ä–≤—ã–π –∏–≥—Ä–æ–∫ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ö–æ—Å—Ç–æ–º</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –æ–∂–∏–¥–∞–Ω–∏—è -->
        <div id="waiting" class="screen hidden">
            <h1>–ì–ª–æ–±–∞–ª—å–Ω–æ–µ –ª–æ–±–±–∏</h1>
            <div class="card" style="text-align: center;">
                <h2 id="waitingTitle">–ò–≥—Ä–æ–∫–æ–≤ –≤ –ª–æ–±–±–∏: 0/8</h2>
                
                <div id="playersList" class="players-list"></div>
                
                <button id="startBtn" class="btn" style="display: none;">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                
                <div style="margin-top: 20px; color: rgba(255,255,255,0.7);">
                    <p>–ú–∏–Ω–∏–º—É–º 2 –∏–≥—Ä–æ–∫–∞ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞</p>
                </div>
            </div>
        </div>

        <!-- –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω -->
        <div id="game" class="screen hidden">
            <h1>–ò–≥—Ä–∞ "–ë—É–Ω–∫–µ—Ä"</h1>
            <div style="display: flex; justify-content: center; gap: 30px; margin: 20px 0; font-size: 16px; color: rgba(255, 255, 255, 0.8); flex-wrap: wrap;">
                <span id="roundInfo" style="padding: 8px 16px; background: rgba(255, 255, 255, 0.05); border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.1);">–†–∞—É–Ω–¥: 1</span>
                <span id="phaseInfo" style="padding: 8px 16px; background: rgba(255, 255, 255, 0.05); border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.1);">–§–∞–∑–∞: –†–∞—Å–∫—Ä—ã—Ç–∏–µ</span>
                <span id="slotsInfo" style="padding: 8px 16px; background: rgba(255, 255, 255, 0.05); border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.1);">–ú–µ—Å—Ç –≤ –±—É–Ω–∫–µ—Ä–µ: 2</span>
            </div>
            <div id="statusMessage" style="text-align: center; margin: 20px 0; padding: 15px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 12px; color: #ffffff; font-weight: 500; backdrop-filter: blur(10px);"></div>
            <div id="playersGrid" style="display: grid; gap: 20px; justify-content: center; margin: 0 auto; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); max-width: 1200px;"></div>
        </div>

        <!-- –≠–∫—Ä–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è -->
        <div id="gameEnd" class="screen hidden">
            <h1>–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!</h1>
            <div class="card" style="text-align: center;">
                <h2>üéâ –í—ã–∂–∏–≤—à–∏–µ:</h2>
                <div id="survivors" style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin: 20px 0;"></div>
                <button id="restartBtn" class="btn">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
            </div>
        </div>
    </div>

    <script>
        // –î–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã
        const professions = [
            '–í—Ä–∞—á', '–£—á–∏—Ç–µ–ª—å', '–ò–Ω–∂–µ–Ω–µ—Ä', '–ü–æ–≤–∞—Ä', '–ü–æ–ª–∏—Ü–µ–π—Å–∫–∏–π', '–ü–æ–∂–∞—Ä–Ω—ã–π',
            '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç', '–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä', '–≠–ª–µ–∫—Ç—Ä–∏–∫', '–°–∞–Ω—Ç–µ—Ö–Ω–∏–∫', '–ú–µ—Ö–∞–Ω–∏–∫',
            '–§–µ—Ä–º–µ—Ä', '–í–µ—Ç–µ—Ä–∏–Ω–∞—Ä', '–ü—Å–∏—Ö–æ–ª–æ–≥', '–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç', '–•—É–¥–æ–∂–Ω–∏–∫',
            '–ú—É–∑—ã–∫–∞–Ω—Ç', '–ê–∫—Ç–µ—Ä', '–¢–∞–Ω—Ü–æ—Ä', '–ü–∏—Å–∞—Ç–µ–ª—å', '–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å',
            '–ü—Ä–æ–¥–∞–≤–µ—Ü', '–ë—É—Ö–≥–∞–ª—Ç–µ—Ä', '–Æ—Ä–∏—Å—Ç', '–°—É–¥—å—è', '–í–æ–µ–Ω–Ω—ã–π',
            '–°—Ç—Ä–∏–ø—Ç–∏–∑–µ—Ä', '–í–µ–Ω–µ—Ä–æ–ª–æ–≥', '–í–µ–±-–∫–∞–º –º–æ–¥–µ–ª—å', '–Æ—Ç—É–±–µ—Ä', '–ü—Ä–æ–¥–∞–≤–µ—Ü –≤ —Å–µ–∫—Å-—à–æ–ø–µ', 
            '–î—Ä–æ–ø—Ö–∞–Ω—Ç–µ—Ä', '–ö–∞–π—Ç–æ –í–∞–ø–ø–µ—Ä', '–ö–¢', '–ü–∏–ª–æ—Ç', '–°—Ç—é–∞—Ä–¥–µ—Å—Å–∞', '–í–æ–¥–∏—Ç–µ–ª—å', '–ü–æ—á—Ç–∞–ª—å–æ–Ω', '–û—Ö—Ä–∞–Ω–Ω–∏–∫'
        ];

        const health = [
            '–ó–¥–æ—Ä–æ–≤', '–ë–ª–∏–∑–æ—Ä—É–∫–æ—Å—Ç—å', '–ê—Å—Ç–º–∞', '–î–∏–∞–±–µ—Ç', '–ê–ª–ª–µ—Ä–≥–∏—è –Ω–∞ –æ—Ä–µ—Ö–∏',
            '–ì–∏–ø–µ—Ä—Ç–æ–Ω–∏—è', '–ê—Ä—Ç—Ä–∏—Ç', '–ú–∏–≥—Ä–µ–Ω—å', '–ë–µ—Å—Å–æ–Ω–Ω–∏—Ü–∞', '–î–µ–ø—Ä–µ—Å—Å–∏—è',
            '–¢—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å', '–°–ø–æ—Ä—Ç–∏–≤–Ω–∞—è —Ç—Ä–∞–≤–º–∞', '–û–ø–µ—Ä–∞—Ü–∏—è –Ω–∞ —Å–µ—Ä–¥—Ü–µ', '–ü—Ä–æ—Ç–µ–∑ –Ω–æ–≥–∏',
            '–°–ª—É—Ö–æ–≤–æ–π –∞–ø–ø–∞—Ä–∞—Ç', '–•—Ä–æ–Ω–∏—á–µ—Å–∫–∏–µ –±–æ–ª–∏ –≤ —Å–ø–∏–Ω–µ', '–≠–ø–∏–ª–µ–ø—Å–∏—è',
            '–ê–Ω–µ–º–∏—è', '–ü–ª–æ—Ö–∞—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è', '–£—Å—Ç–∞–ª–æ—Å—Ç—å'
        ];

        const hobbies = [
            '–ß—Ç–µ–Ω–∏–µ', '–°–ø–æ—Ä—Ç', '–ì–æ—Ç–æ–≤–∫–∞', '–†–∏—Å–æ–≤–∞–Ω–∏–µ', '–ú—É–∑—ã–∫–∞', '–¢–∞–Ω—Ü—ã',
            '–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è', '–°–∞–¥–æ–≤–æ–¥—Å—Ç–≤–æ', '–†—ã–±–∞–ª–∫–∞', '–û—Ö–æ—Ç–∞', '–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏—è',
            '–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ', '–í—è–∑–∞–Ω–∏–µ', '–®–∞—Ö–º–∞—Ç—ã', '–í–∏–¥–µ–æ–∏–≥—Ä—ã', '–ö–∏–Ω–æ',
            '–¢–µ–∞—Ç—Ä', '–ê—Å—Ç—Ä–æ–Ω–æ–º–∏—è', '–ì–µ–æ–ª–æ–≥–∏—è', '–ê—Ä—Ö–µ–æ–ª–æ–≥–∏—è', '–ò—Å—Ç–æ—Ä–∏—è',
            '–Ø–∑—ã–∫–∏', '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ', '–†–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞', '–ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ',
            '–°–∫–∞–ª–æ–ª–∞–∑–∞–Ω–∏–µ', '–ü–∞—Ä–∞—à—é—Ç–∏–∑–º', '–î–∞–π–≤–∏–Ω–≥', '–°–µ—Ä—Ñ–∏–Ω–≥', '–ô–æ–≥–∞'
        ];

        const phobias = [
            '–ê—Ä–∞—Ö–Ω–æ—Ñ–æ–±–∏—è (–ø–∞—É–∫–∏)', '–ö–ª–∞—É—Å—Ç—Ä–æ—Ñ–æ–±–∏—è (–∑–∞–º–∫–Ω—É—Ç—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞)', 
            '–ê–∫—Ä–æ—Ñ–æ–±–∏—è (–≤—ã—Å–æ—Ç–∞)', '–ê—ç—Ä–æ—Ñ–æ–±–∏—è (–ø–æ–ª–µ—Ç—ã)', '–ê–∫–≤–∞—Ñ–æ–±–∏—è (–≤–æ–¥–∞)',
            '–°–æ—Ü–∏–æ—Ñ–æ–±–∏—è (–ª—é–¥–∏)', '–ê–≥–æ—Ä–∞—Ñ–æ–±–∏—è (–æ—Ç–∫—Ä—ã—Ç—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞)',
            '–ù–∏–∫—Ç–æ—Ñ–æ–±–∏—è (—Ç–µ–º–Ω–æ—Ç–∞)', '–û—Ñ–∏–¥–∏–æ—Ñ–æ–±–∏—è (–∑–º–µ–∏)', '–ö–∏–Ω–æ—Ñ–æ–±–∏—è (—Å–æ–±–∞–∫–∏)',
            '–ú–∏–∑–æ—Ñ–æ–±–∏—è (–≥—Ä—è–∑—å)', '–ì–µ–º–æ—Ñ–æ–±–∏—è (–∫—Ä–æ–≤—å)', '–¢–∞–Ω–∞—Ç–æ—Ñ–æ–±–∏—è (—Å–º–µ—Ä—Ç—å)',
            '–ê—É—Ç–æ—Ñ–æ–±–∏—è (–æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–æ)', '–§–æ–Ω–æ—Ñ–æ–±–∏—è (–≥—Ä–æ–º–∫–∏–µ –∑–≤—É–∫–∏)',
            '–ü–∏—Ä–æ—Ñ–æ–±–∏—è (–æ–≥–æ–Ω—å)', '–¢—Ä–∏–ø–æ—Ñ–æ–±–∏—è (–¥—ã—Ä–∫–∏)', '–≠–Ω—Ç–æ–º–æ—Ñ–æ–±–∏—è (–Ω–∞—Å–µ–∫–æ–º—ã–µ)',
            '–ú–µ—Ç–µ–æ—Ä–æ—Ñ–æ–±–∏—è (–ø–æ–≥–æ–¥–∞)', '–ö—Å–µ–Ω–æ—Ñ–æ–±–∏—è (–Ω–µ–∑–Ω–∞–∫–æ–º—Ü—ã)'
        ];

        const baggage = [
            '–†—é–∫–∑–∞–∫ —Å –µ–¥–æ–π', '–ê–ø—Ç–µ—á–∫–∞', '–ù–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤',
            '–°–ø–∞–ª—å–Ω—ã–π –º–µ—à–æ–∫', '–ü–∞–ª–∞—Ç–∫–∞', '–§–æ–Ω–∞—Ä–∏–∫ —Å –±–∞—Ç–∞—Ä–µ–π–∫–∞–º–∏',
            '–†–∞–¥–∏–æ', '–ö–æ–º–ø–∞—Å –∏ –∫–∞—Ä—Ç—ã', '–í–µ—Ä–µ–≤–∫–∞ 50–º', '–ù–æ–∂',
            '–ó–∞–∂–∏–≥–∞–ª–∫–∞', '–í–æ–¥–æ–Ω–µ–ø—Ä–æ–Ω–∏—Ü–∞–µ–º—ã–µ —Å–ø–∏—á–∫–∏', '–ö–æ–Ω—Å–µ—Ä–≤—ã', '–í–æ–¥–∞ 10–ª',
            '–û–¥–µ—è–ª–æ', '–ó–∞–ø–∞—Å–Ω–∞—è –æ–¥–µ–∂–¥–∞', '–ö–Ω–∏–≥–∏', '–ò–≥—Ä–∞–ª—å–Ω—ã–µ –∫–∞—Ä—Ç—ã',
            '–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç', '–§–æ—Ç–æ–∞–ø–ø–∞—Ä–∞—Ç', '–î–æ–∫—É–º–µ–Ω—Ç—ã',
            '–î–µ–Ω—å–≥–∏', '–î—Ä–∞–≥–æ—Ü–µ–Ω–Ω–æ—Å—Ç–∏', '–°–µ–º–µ–π–Ω—ã–µ —Ñ–æ—Ç–æ', '–û—Ä—É–∂–∏–µ',
            '–ê–ª–∫–æ–≥–æ–ª—å', '–°–∏–≥–∞—Ä–µ—Ç—ã', '–õ–µ–∫–∞—Ä—Å—Ç–≤–∞', '–°–µ–º–µ–Ω–∞ —Ä–∞—Å—Ç–µ–Ω–∏–π', '–£–¥–æ—á–∫–∞'
        ];

        const facts = [
            '–°–ª—É–∂–∏–ª –≤ –∞—Ä–º–∏–∏', '–ó–Ω–∞–µ—Ç –±–æ–µ–≤—ã–µ –∏—Å–∫—É—Å—Å—Ç–≤–∞', '–£–º–µ–µ—Ç –≥–æ—Ç–æ–≤–∏—Ç—å',
            '–ì–æ–≤–æ—Ä–∏—Ç –Ω–∞ 3 —è–∑—ã–∫–∞—Ö', '–ï—Å—Ç—å –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–µ –ø—Ä–∞–≤–∞', '–£–º–µ–µ—Ç —à–∏—Ç—å',
            '–ó–Ω–∞–µ—Ç –ø–µ—Ä–≤—É—é –ø–æ–º–æ—â—å', '–£–º–µ–µ—Ç —á–∏–Ω–∏—Ç—å —Ç–µ—Ö–Ω–∏–∫—É', '–•–æ—Ä–æ—à–æ —Å—Ç—Ä–µ–ª—è–µ—Ç',
            '–ó–Ω–∞–µ—Ç –≤—ã–∂–∏–≤–∞–Ω–∏–µ –≤ –¥–∏–∫–æ–π –ø—Ä–∏—Ä–æ–¥–µ', '–ó–Ω–∞–µ—Ç –ø—Å–∏—Ö–æ–ª–æ–≥–∏—é', '–£–º–µ–µ—Ç –ø–µ—Ç—å',
            '–•–æ—Ä–æ—à–æ —Ç–∞–Ω—Ü—É–µ—Ç', '–ò–≥—Ä–∞–µ—Ç –Ω–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–µ', '–ó–Ω–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é',
            '–ë—ã—Å—Ç—Ä–æ —Å—á–∏—Ç–∞–µ—Ç', '–•–æ—Ä–æ—à–∞—è –ø–∞–º—è—Ç—å', '–ó–Ω–∞–µ—Ç –≥–µ–æ–≥—Ä–∞—Ñ–∏—é',
            '–£–º–µ–µ—Ç —Ä–∏—Å–æ–≤–∞—Ç—å –∫–∞—Ä—Ç—ã', '–ó–Ω–∞–µ—Ç –∞—Å—Ç—Ä–æ–Ω–æ–º–∏—é', '–ú–æ–∂–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–≥–æ–¥—É',
            '–•–æ—Ä–æ—à–æ –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è', '–£–º–µ–µ—Ç –ª–∞–∑–∞—Ç—å –ø–æ –¥–µ—Ä–µ–≤—å—è–º', '–ë—ã—Å—Ç—Ä–æ –±–µ–≥–∞–µ—Ç',
            '–°–∏–ª—å–Ω—ã–µ —Ä—É–∫–∏', '–•–æ—Ä–æ—à–µ–µ –∑—Ä–µ–Ω–∏–µ', '–û—Å—Ç—Ä—ã–π —Å–ª—É—Ö', '–ß—É–µ—Ç –æ–ø–∞—Å–Ω–æ—Å—Ç—å',
            '–£–º–µ–µ—Ç —É–±–µ–∂–¥–∞—Ç—å', '–•–æ—Ä–æ—à–∏–π –ª–∏–¥–µ—Ä'
        ];

        const characteristicNames = {
            profession: '–ü—Ä–æ—Ñ–µ—Å—Å–∏—è',
            health: '–ó–¥–æ—Ä–æ–≤—å–µ',
            hobbies: '–•–æ–±–±–∏',
            phobias: '–§–æ–±–∏–∏',
            baggage: '–ë–∞–≥–∞–∂',
            facts1: '–§–∞–∫—Ç 1',
            facts2: '–§–∞–∫—Ç 2',
            gender: '–ü–æ–ª',
            age: '–í–æ–∑—Ä–∞—Å—Ç'
        };

        function getRandomItem(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        function generateRandomCharacteristics() {
            return {
                profession: getRandomItem(professions),
                health: getRandomItem(health),
                hobbies: getRandomItem(hobbies),
                phobias: getRandomItem(phobias),
                baggage: getRandomItem(baggage),
                facts1: getRandomItem(facts),
                facts2: getRandomItem(facts),
                gender: getRandomItem(['–ú—É–∂—á–∏–Ω–∞', '–ñ–µ–Ω—â–∏–Ω–∞']),
                age: Math.floor(Math.random() * 70) + 21
            };
        }

        // API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Vercel —Ñ—É–Ω–∫—Ü–∏—è–º–∏
        class VercelAPI {
            constructor() {
                this.isOnline = false;
                this.debug = true;
            }

            log(message) {
                if (this.debug) {
                    console.log(`[API] ${message}`);
                }
            }

            async init() {
                this.log('üåê –ü—Ä–æ–≤–µ—Ä–∫–∞ API...');
                
                try {
                    const response = await fetch('/api/game', {
                        method: 'GET',
                        headers: { 'Content-Type': 'application/json' },
                        signal: AbortSignal.timeout(5000)
                    });
                    
                    this.isOnline = response.ok;
                    this.log(this.isOnline ? '‚úÖ API –≥–æ—Ç–æ–≤' : '‚ùå API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
                    return this.isOnline;
                } catch (error) {
                    this.log(`‚ùå –û—à–∏–±–∫–∞ API: ${error.message}`);
                    this.isOnline = false;
                    return false;
                }
            }

            async joinGame(playerData) {
                try {
                    const response = await fetch('/api/game', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            action: 'join',
                            player: playerData
                        })
                    });

                    if (response.ok) {
                        const result = await response.json();
                        this.log(`‚úÖ –ò–≥—Ä–æ–∫ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è. –í—Å–µ–≥–æ: ${result.players.length}`);
                        return result;
                    } else {
                        const error = await response.text();
                        throw new Error(error || '–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
                    }
                } catch (error) {
                    this.log(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: ${error.message}`);
                    throw error;
                }
            }

            async getGameState() {
                try {
                    const response = await fetch('/api/game');
                    if (response.ok) {
                        return await response.json();
                    }
                    return null;
                } catch (error) {
                    this.log(`‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è: ${error.message}`);
                    return null;
                }
            }

            async updateGameState(gameState) {
                try {
                    const response = await fetch('/api/game', {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            action: 'update',
                            gameState: gameState
                        })
                    });
                    
                    return response.ok;
                } catch (error) {
                    this.log(`‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: ${error.message}`);
                    return false;
                }
            }
        }

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let gameState = null;
        let currentPlayer = null;
        let isHost = false;
        let hasVoted = false;
        let api = null;
        let syncInterval = null;

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const elements = {
            lobby: document.getElementById('lobby'),
            waiting: document.getElementById('waiting'),
            game: document.getElementById('game'),
            gameEnd: document.getElementById('gameEnd'),
            playerName: document.getElementById('playerName'),
            joinBtn: document.getElementById('joinBtn'),
            startBtn: document.getElementById('startBtn'),
            restartBtn: document.getElementById('restartBtn'),
            waitingTitle: document.getElementById('waitingTitle'),
            playersList: document.getElementById('playersList'),
            playersGrid: document.getElementById('playersGrid'),
            roundInfo: document.getElementById('roundInfo'),
            phaseInfo: document.getElementById('phaseInfo'),
            slotsInfo: document.getElementById('slotsInfo'),
            statusMessage: document.getElementById('statusMessage'),
            survivors: document.getElementById('survivors'),
            status: document.getElementById('status'),
            error: document.getElementById('error')
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('üéÆ –ò–≥—Ä–∞ "–ë—É–Ω–∫–µ—Ä" –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...');
            
            api = new VercelAPI();
            const isConnected = await api.init();
            
            updateStatus(isConnected ? 'üü¢ –ì–æ—Ç–æ–≤ –∫ –∏–≥—Ä–µ' : 'üî¥ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
            
            setupEventListeners();
            showScreen('lobby');
            
            console.log('‚úÖ –ò–≥—Ä–∞ –≥–æ—Ç–æ–≤–∞!');
        });

        function setupEventListeners() {
            elements.joinBtn.addEventListener('click', joinGame);
            elements.startBtn.addEventListener('click', startGame);
            elements.restartBtn.addEventListener('click', restartGame);
            
            elements.playerName.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    joinGame();
                }
            });
        }

        function showScreen(screenName) {
            console.log('üì∫ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —ç–∫—Ä–∞–Ω:', screenName);
            const screens = ['lobby', 'waiting', 'game', 'gameEnd'];
            screens.forEach(screen => {
                if (elements[screen]) {
                    elements[screen].classList.add('hidden');
                }
            });
            if (elements[screenName]) {
                elements[screenName].classList.remove('hidden');
            }
        }

        function updateStatus(message) {
            elements.status.textContent = message;
            elements.status.className = 'status';
            if (message.includes('üî¥')) {
                elements.status.classList.add('offline');
            } else if (message.includes('üü°')) {
                elements.status.classList.add('connecting');
            }
        }

        function showError(message) {
            elements.error.textContent = message;
            elements.error.style.display = 'block';
        }

        function hideError() {
            elements.error.style.display = 'none';
        }

        async function joinGame() {
            const name = elements.playerName.value.trim();
            
            hideError();
            updateStatus('üü° –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...');
            
            if (!name) {
                showError('–í–≤–µ–¥–∏—Ç–µ –∏–º—è!');
                updateStatus('üî¥ –û—à–∏–±–∫–∞');
                return;
            }

            if (!api.isOnline) {
                showError('API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ.');
                updateStatus('üî¥ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
                return;
            }

            try {
                elements.joinBtn.disabled = true;

                const newPlayer = {
                    id: Math.random().toString(36).substr(2, 9),
                    name: name,
                    characteristics: generateRandomCharacteristics(),
                    revealedCharacteristics: [],
                    isAlive: true,
                    votesReceived: 0
                };

                gameState = await api.joinGame(newPlayer);
                currentPlayer = newPlayer;
                isHost = (gameState.hostId === newPlayer.id);

                showScreen('waiting');
                updateWaitingScreen();
                startSync();

                updateStatus('üü¢ –í –ª–æ–±–±–∏');
                console.log('üéØ –£—Å–ø–µ—à–Ω–æ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å –∫ –ª–æ–±–±–∏');
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
                showError('–û—à–∏–±–∫–∞: ' + error.message);
                updateStatus('üî¥ –û—à–∏–±–∫–∞');
                elements.joinBtn.disabled = false;
            }
        }

        function updateWaitingScreen() {
            const hostIndicator = isHost ? ' (–í—ã - —Ö–æ—Å—Ç üëë)' : '';
            elements.waitingTitle.textContent = `–ò–≥—Ä–æ–∫–æ–≤ –≤ –ª–æ–±–±–∏: ${gameState.players.length}/8${hostIndicator}`;
            
            elements.playersList.innerHTML = '';
            gameState.players.forEach(player => {
                const div = document.createElement('div');
                div.className = 'player-item';
                const hostIcon = player.id === gameState.hostId ? 'üëë ' : '';
                div.textContent = hostIcon + player.name;
                elements.playersList.appendChild(div);
            });

            // –•–æ—Å—Ç –º–æ–∂–µ—Ç –Ω–∞—á–∞—Ç—å –∏–≥—Ä—É –ø—Ä–∏ 2+ –∏–≥—Ä–æ–∫–∞—Ö
            if (gameState.players.length >= 2 && isHost) {
                elements.startBtn.style.display = 'block';
            } else {
                elements.startBtn.style.display = 'none';
            }
        }

        async function startGame() {
            if (!isHost) {
                alert('–¢–æ–ª—å–∫–æ —Ö–æ—Å—Ç –º–æ–∂–µ—Ç –Ω–∞—á–∞—Ç—å –∏–≥—Ä—É!');
                return;
            }

            if (gameState.players.length < 2) {
                alert('–ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 –∏–≥—Ä–æ–∫–∞!');
                return;
            }

            gameState.phase = 'revealing';
            gameState.currentPlayerId = gameState.players[0].id;
            gameState.round = 1;
            gameState.bunkerSlots = Math.max(1, Math.floor(gameState.players.length / 2));
            
            await api.updateGameState(gameState);
            
            showScreen('game');
            updateGameInfo();
            updatePlayersGrid();
            updateStatus();
        }

        function startSync() {
            if (syncInterval) {
                clearInterval(syncInterval);
            }
            
            syncInterval = setInterval(async () => {
                try {
                    const latestState = await api.getGameState();
                    if (latestState && latestState.lastUpdate > gameState.lastUpdate) {
                        gameState = latestState;
                        updateUI();
                        console.log('üîÑ –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
                    }
                } catch (error) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:', error);
                }
            }, 2000);
        }

        function updateUI() {
            if (gameState.phase === 'waiting') {
                showScreen('waiting');
                updateWaitingScreen();
            } else if (gameState.phase === 'ended') {
                showScreen('gameEnd');
                updateSurvivors();
            } else if (['revealing', 'voting'].includes(gameState.phase)) {
                showScreen('game');
                updateGameInfo();
                updatePlayersGrid();
                updateStatus();
            }
        }

        function updateGameInfo() {
            elements.roundInfo.textContent = `–†–∞—É–Ω–¥: ${gameState.round}`;
            
            const phaseNames = {
                revealing: '–†–∞—Å–∫—Ä—ã—Ç–∏–µ',
                voting: '–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ',
                ended: '–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞'
            };
            elements.phaseInfo.textContent = `–§–∞–∑–∞: ${phaseNames[gameState.phase]}`;
            elements.slotsInfo.textContent = `–ú–µ—Å—Ç –≤ –±—É–Ω–∫–µ—Ä–µ: ${gameState.bunkerSlots}`;
        }

        function updateStatus() {
            let message = '';
            if (gameState.phase === 'revealing' && gameState.currentPlayerId) {
                const currentPlayerName = gameState.players.find(p => p.id === gameState.currentPlayerId)?.name;
                message = `${currentPlayerName} —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫—É`;
            } else if (gameState.phase === 'voting') {
                message = 'üó≥Ô∏è –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ! –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–≥–æ –∏—Å–∫–ª—é—á–∏—Ç—å';
            }
            elements.statusMessage.textContent = message;
        }

        function updatePlayersGrid() {
            elements.playersGrid.innerHTML = '';
            
            gameState.players.forEach(player => {
                const card = createPlayerCard(player);
                elements.playersGrid.appendChild(card);
            });
        }

        function createPlayerCard(player) {
            const card = document.createElement('div');
            card.className = `player-card ${!player.isAlive ? 'eliminated' : ''} ${gameState.currentPlayerId === player.id ? 'current-player' : ''}`;

            const header = document.createElement('div');
            header.className = 'player-header';
            
            const name = document.createElement('h3');
            name.className = 'player-name';
            const hostIcon = player.id === gameState.hostId ? 'üëë ' : '';
            name.textContent = hostIcon + player.name;
            header.appendChild(name);

            if (!player.isAlive) {
                const badge = document.createElement('span');
                badge.className = 'eliminated-badge';
                badge.textContent = '–ò—Å–∫–ª—é—á–µ–Ω';
                header.appendChild(badge);
            }

            if (gameState.phase === 'voting' && player.id !== currentPlayer?.id && player.isAlive && !hasVoted) {
                const voteBtn = document.createElement('button');
                voteBtn.className = 'btn vote-btn';
                voteBtn.textContent = '–ì–æ–ª–æ—Å–æ–≤–∞—Ç—å';
                voteBtn.onclick = () => vote(player.id);
                header.appendChild(voteBtn);
            }

            card.appendChild(header);

            const charGrid = document.createElement('div');
            charGrid.className = 'characteristics-grid';

            Object.keys(player.characteristics || {}).forEach(char => {
                const item = document.createElement('div');
                item.className = 'characteristic-item';

                const label = document.createElement('div');
                label.className = 'characteristic-label';
                label.textContent = `${characteristicNames[char]}:`;

                const value = document.createElement('div');
                value.className = 'characteristic-value';

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º - —ç—Ç–æ —Å–≤–æ–π –∏–≥—Ä–æ–∫ –∏–ª–∏ —á—É–∂–æ–π
                const isOwnPlayer = player.id === currentPlayer?.id;
                const isRevealed = player.revealedCharacteristics?.includes(char);

                if (isOwnPlayer) {
                    // –°–≤–æ–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≤–∏–¥–∏–º –≤—Å–µ–≥–¥–∞
                    if (gameState.phase === 'revealing' && gameState.currentPlayerId === player.id && !isRevealed) {
                        // –ú–æ–∂–µ–º —Ä–∞—Å–∫—Ä—ã—Ç—å —Å–≤–æ—é —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫—É
                        const revealBtn = document.createElement('button');
                        revealBtn.className = 'btn reveal-btn';
                        revealBtn.textContent = '–†–∞—Å–∫—Ä—ã—Ç—å';
                        revealBtn.onclick = () => revealCharacteristic(char);
                        value.appendChild(revealBtn);
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–≤—å—é —Å–≤–æ–µ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
                        const preview = document.createElement('div');
                        preview.className = 'characteristic-preview';
                        preview.textContent = char === 'age' ? `${player.characteristics[char]} –ª–µ—Ç` : player.characteristics[char];
                        value.appendChild(preview);
                    } else {
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–≤–æ—é —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫—É
                        const revealed = document.createElement('span');
                        revealed.className = isRevealed ? 'revealed-value' : 'own-value';
                        revealed.textContent = char === 'age' ? `${player.characteristics[char]} –ª–µ—Ç` : player.characteristics[char];
                        value.appendChild(revealed);
                    }
                } else {
                    // –ß—É–∂–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≤–∏–¥–∏–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ä–∞—Å–∫—Ä—ã—Ç—ã
                    if (isRevealed) {
                        const revealed = document.createElement('span');
                        revealed.className = 'revealed-value';
                        revealed.textContent = char === 'age' ? `${player.characteristics[char]} –ª–µ—Ç` : player.characteristics[char];
                        value.appendChild(revealed);
                    } else {
                        const hidden = document.createElement('span');
                        hidden.className = 'hidden-value';
                        hidden.textContent = '???';
                        value.appendChild(hidden);
                    }
                }

                item.appendChild(label);
                item.appendChild(value);
                charGrid.appendChild(item);
            });

            card.appendChild(charGrid);

            if (player.votesReceived > 0) {
                const votesDisplay = document.createElement('div');
                votesDisplay.className = 'votes-display';
                votesDisplay.textContent = `–ì–æ–ª–æ—Å–æ–≤: ${player.votesReceived}`;
                card.appendChild(votesDisplay);
            }

            return card;
        }

        async function revealCharacteristic(char) {
            if (!currentPlayer || gameState.currentPlayerId !== currentPlayer.id) return;

            const player = gameState.players.find(p => p.id === currentPlayer.id);
            if (player) {
                player.revealedCharacteristics = player.revealedCharacteristics || [];
                player.revealedCharacteristics.push(char);
                currentPlayer.revealedCharacteristics.push(char);
            }

            await api.updateGameState(gameState);

            setTimeout(async () => {
                const alivePlayers = gameState.players.filter(p => p.isAlive);
                const currentIndex = alivePlayers.findIndex(p => p.id === gameState.currentPlayerId);
                const nextIndex = (currentIndex + 1) % alivePlayers.length;

                if (nextIndex === 0) {
                    gameState.phase = 'voting';
                    gameState.currentPlayerId = null;
                } else {
                    gameState.currentPlayerId = alivePlayers[nextIndex].id;
                }

                await api.updateGameState(gameState);
            }, 1500);
        }

        async function vote(playerId) {
            if (hasVoted) return;

            gameState.votingResults = gameState.votingResults || {};
            gameState.votingResults[playerId] = (gameState.votingResults[playerId] || 0) + 1;
            hasVoted = true;
            
            await api.updateGameState(gameState);

            const alivePlayers = gameState.players.filter(p => p.isAlive);
            const totalVotes = Object.values(gameState.votingResults).reduce((sum, votes) => sum + votes, 0);
            
            if (totalVotes >= alivePlayers.length) {
                setTimeout(async () => {
                    await processVoting();
                }, 2000);
            }
        }

        async function processVoting() {
            let maxVotes = 0;
            let eliminatedId = null;

            Object.entries(gameState.votingResults).forEach(([playerId, votes]) => {
                if (votes > maxVotes) {
                    maxVotes = votes;
                    eliminatedId = playerId;
                }
                const player = gameState.players.find(p => p.id === playerId);
                if (player) player.votesReceived = votes;
            });

            if (eliminatedId) {
                const eliminated = gameState.players.find(p => p.id === eliminatedId);
                if (eliminated) {
                    eliminated.isAlive = false;
                }

                await api.updateGameState(gameState);

                setTimeout(async () => {
                    const remaining = gameState.players.filter(p => p.isAlive);
                    
                    if (remaining.length <= gameState.bunkerSlots) {
                        await endGame();
                    } else {
                        await startNextRound();
                    }
                }, 2000);
            }
        }

        async function startNextRound() {
            gameState.round++;
            gameState.phase = 'revealing';
            gameState.votingResults = {};
            gameState.currentPlayerId = gameState.players.filter(p => p.isAlive)[0]?.id;
            hasVoted = false;

            gameState.players.forEach(p => p.votesReceived = 0);

            await api.updateGameState(gameState);
        }

        async function endGame() {
            gameState.phase = 'ended';
            await api.updateGameState(gameState);
            
            showScreen('gameEnd');
            updateSurvivors();
        }

        function updateSurvivors() {
            elements.survivors.innerHTML = '';
            gameState.players.filter(p => p.isAlive).forEach(player => {
                const div = document.createElement('div');
                div.className = 'survivor';
                const hostIcon = player.id === gameState.hostId ? 'üëë ' : '';
                div.textContent = hostIcon + player.name;
                elements.survivors.appendChild(div);
            });
        }

        async function restartGame() {
            if (!isHost) {
                alert('–¢–æ–ª—å–∫–æ —Ö–æ—Å—Ç –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä—É!');
                return;
            }

            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã, –Ω–æ –æ—Å—Ç–∞–≤–ª—è–µ–º –∏–≥—Ä–æ–∫–æ–≤ –≤ –ª–æ–±–±–∏
            gameState.phase = 'waiting';
            gameState.round = 1;
            gameState.currentPlayerId = null;
            gameState.votingResults = {};
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤
            gameState.players.forEach(player => {
                player.isAlive = true;
                player.votesReceived = 0;
                player.revealedCharacteristics = [];
                player.characteristics = generateRandomCharacteristics();
            });

            hasVoted = false;
            
            await api.updateGameState(gameState);

            showScreen('waiting');
            updateWaitingScreen();
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('beforeunload', () => {
            if (syncInterval) {
                clearInterval(syncInterval);
            }
        });

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å—Ç–∞—Ä—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üéÆ Bunker Game –∑–∞–ø—É—â–µ–Ω!');
            
            setupEventListeners();
            showScreen('lobby');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
            try {
                const state = await api.getGameState();
                if (state) {
                    gameState = state;
                    console.log('üì• –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã:', gameState);
                } else {
                    console.log('üÜï –°–æ–∑–¥–∞–Ω–æ –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã');
                }
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
            }
        });
    </script>
</body>
</html>
